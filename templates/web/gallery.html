{%extends 'web/dbase.html'%} {%load static%} {%block headers%} {% load mathfilters %}

<!-- Favicon -->
{% endblock %}

<link href="https://fonts.googleapis.com/css?family=Montserrat:500,700&display=swap&subset=latin-ext" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,600&display=swap&subset=latin-ext" rel="stylesheet">
    
    <link type="text/css" rel="stylesheet" href={% static "web/css/bootstrap.css" %} />
    <link type="text/css" rel="stylesheet" href={% static "web/css/fontawesome-all.css" %} />
    <link type="text/css" rel="stylesheet" href={% static "web/css/swiper.css" %}>
    <link type="text/css" rel="stylesheet" href={% static "web/css/magnific-popup.css" %}>
    <link type="text/css" rel="stylesheet" href={% static "web/css/styles.css" %}>
    <style>
    .ithramathi {
        object-fit: cover;
        max-height: 700px;
        min-width: auto;
    }
    .wrapper {
     display: flex;
    align-items: center;
    justify-content: center;
    }
    </style>

</head>

<body>

    {%block body%}


    <!-- Page Inner Start -->
    <!--================================-->
    <div class="page-inner">
        <!-- Main Wrapper -->
        <div id="main-wrapper">
            <!--Home-->
            <div class="row">
                <div class="col-lg-12">
                    <h2>Gallery</h2>
                </div> <!-- end of col -->
            </div>
            <br><br><br>
              <div class ="row">
            <!-- Card -->
            <div class="card col-lg-12 col-centered jcard" >
                <form id="gal" data-toggle="validator" data-focus="false">
                    <div class="form-group">
                      <label for="exampleFormControlFile1">Image File</label>
                      <input type="file" name="image" class="form-control-file" id="logop">
                      <br><button id="submit" style="background-color:#000000	; border-color: white;" class="btn btn-custom-primary">Update</button>
                    </div>
                  </form>
            </div>
            <!-- end of card -->
           
            <!-- Card -->
            
        </div>
        <br><br><br><br><br><br>
           <!--Services mid section ends-->

                
                <div class="row package-grids mt-5" data-toggle="modal" data-target="#exampleModal">
                    {%for g in object_list%}
                    <div class="col-md-4 pricing ">
                        <div class="price-top ">
                                
                                <img src={{g.image.url}} alt=" " class="img-fluid " style="height: 200px; width: 100% " data-target="#carouselExample" data-slide-to={{forloop.counter|sub:1}} />
                                <div class="price-bottom p-4 ">
                                    <button class="postmagic"  style="display: block; margin: 0 auto;" data-id={{g.id}} data-link='/deletegal' data-success='Data has been deleted' data-failure='Cannot delete now, please try again later'><i
                                        class="fa fa-trash"></i></button>
                                </div>
        
                        </div>
                        
                    </div>
                    {%endfor%}
        
                    
            </div>

            <div class="card-body collapse show " id="collapse5 ">
                <nav aria-label="Page navigation example ">
                    <ul class="pagination justify-content-center pagination-sm mb-0 ">
                        {% if page_obj.has_previous %}
                        <li class="page-item ">
                            <a class="page-link " href="/dgal?page=1 ">&laquo;
                                first</a>
                        </li>
                        {% endif %} {% if page_obj.has_previous %}
                        <li class="page-item ">
                            <a class="page-link " href="/dgal?page={{ page_obj.previous_page_number }} ">previous</a>
                        </li>
                        {% endif %}
                        <li class="page-item "> <a class="page-link " href="# ">{{ page_obj.number }}</a></li>
                        {% if page_obj.has_next %}
                        <li class="page-item ">
                            <a class="page-link " href="/dgal?page={{ page_obj.next_page_number }} ">next</a>
                        </li>{% endif %} {% if page_obj.has_next %}
                        <li class="page-item ">
                            <a class="page-link " href="/dgal?page={{ page_obj.paginator.num_pages }} ">last
                                &raquo;</a>
                        </li>{% endif %}
                    </ul>
                </nav>
           
        </div>


            
        
        
        </div>
        <!--/ Main Wrapper End -->
    </div>
    <!--/ Page Inner End -->


        
    



<!--LIGHTBOX-->
<!-- Modal markup: https://getbootstrap.com/docs/4.4/components/modal/ -->
<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">Ã—</span>
          </button>
        </div>
        <div class="modal-body">
          
        <!-- Carousel markup: https://getbootstrap.com/docs/4.4/components/carousel/ -->
        <div id="carouselExample" class="carousel slide" data-ride="carousel">
            <div class="carousel-inner">
              {%for g in object_list%}
              {%if forloop.counter == 1%}
                <div class="carousel-item active">
                <img class="d-block w-100" src={{g.image.url}}>
              </div>
              {%endif%}
              {%endfor%}
              {%for g in object_list%}

              {%if forloop.counter > 1%}
              <div class="carousel-item">
                <img class="d-block w-100" src={{g.image.url}}>
              </div>
              {%endif%}
              {%endfor%}

            </div>
            <a class="carousel-control-prev" href="#carouselExample" role="button" data-slide="prev">
              <span class="carousel-control-prev-icon" aria-hidden="true"></span>
              <span class="sr-only">Previous</span>
            </a>
            <a class="carousel-control-next" href="#carouselExample" role="button" data-slide="next">
              <span class="carousel-control-next-icon" aria-hidden="true"></span>
              <span class="sr-only">Next</span>
            </a>
          </div>
        </div>
  
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>


<!--LIGHTBOX ENDS-->



    <!--================================-->
    <!-- Page Footer Start -->
    <!--================================-->




    <footer class="page-footer">
        <div class="pd-t-4 pd-b-0 pd-x-20">
            <div class="tx-10 tx-uppercase">
                <p class="pd-y-10 mb-0">Copyright&copy; 2020 | All rights reserved. | Developed By <a href="" target="_blank">Abhijith V K</a></p>
            </div>
        </div>
    </footer>
    <!--/ Page Footer End -->
    </div>
    <!--/ Page Content End -->
    </div>
        
    <!-- The Modal -->
    <div class="modal" id="thankyouModal" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <!-- Modal Header -->
                <div class="modal-header">
                    <h4 class="modal-title">
                        <li class="far fa-check-circle"></li> Done
                    </h4>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>
                <!-- Modal body -->
                <div class="modal-body">
                    Have been successfully updated.
                </div>
                <!-- Modal footer -->
                <div class="modal-footer">
                    
                    <button type="button" id="modalbut" class="btn btn-danger" data-dismiss="modal">Close</button>
                </div>

            </div>
        </div>
    </div>

    <!--/ Page Container End -->
    <!--================================-->
    <!-- Scroll To Top Start-->
    <!--================================-->
    <a href="" data-click="scroll-top" class="btn-scroll-top fade"><i class="fa fa-arrow-up"></i></a>
    <!--/ Scroll To Top End -->
    <!--================================-->

    <!--================================-->
    <!-- Footer Script -->
    <!--================================-->
    {%endblock%} {%block script%}

    
 <script>
    jQuery(document).ready(function () {

        var token = '{{csrf_token}}';
        $('#modalbut').click(function(){
            location.reload(); 
        })

        $("#submit").click(function (event) {
    event.preventDefault();

    var form = $('#gal')[0];
    var data = new FormData(form);
    $.ajax({
                headers: {
                    "X-CSRFToken": token
                },
                type: "POST",
                enctype: 'multipart/form-data',
                url: "/addgal",
                data: data,
                processData: false,
                contentType: false,
                cache: false,
                timeout: 600000,
                async: true,

                success: function(data) {
                    $("#result").text(data);
                    console.log("SUCCESS : ", data);
                    $("#thankyouModal").modal('show')
                    $("#thankyouModal").css("z-index", "1500");
                },
                error: function(e) {
                    $("#result").text(e.responseText);
                    console.log("ERROR : ", e);
                    }

    })        

});



    
})
    

</script>
    

</body>

{% endblock %}